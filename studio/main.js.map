{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"Studio\"","webpack:///./studio/main_dev.js","webpack:///./studio/ShareModal.js","webpack:///external \"Studio.libraries['react']\"","webpack:///./studio/ShareModal.scss"],"names":["Studio","addToolbarComponent","props","tab","entity","__entitySet","openModal","ShareModal","state","options","method","api","post","shortid","response","tokenProperty","updated","token","updateEntity","setState","_id","readSharingToken","saveEntity","rootUrl","generateLink","Style","infoBox","close","removeLink","Component","propTypes","PropTypes","func","isRequired","object"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = Studio;","import Studio from 'jsreport-studio'\nimport ShareModal from './ShareModal.js'\n\nStudio.addToolbarComponent((props) => {\n  if (!props.tab || !props.tab.entity || props.tab.entity.__entitySet !== 'templates') {\n    return <span />\n  }\n\n  return <div className='toolbar-button' onClick={() => Studio.openModal(ShareModal, {entity: props.tab.entity})}>\n    <i className='fa fa-unlock' />Share\n  </div>\n})\n","import React, {Component, PropTypes} from 'react'\r\nimport Studio from 'jsreport-studio'\r\nimport Style from './ShareModal.scss'\r\n\r\nexport default class ShareModal extends Component {\r\n  static propTypes = {\r\n    close: PropTypes.func.isRequired,\r\n    options: PropTypes.object.isRequired\r\n  }\r\n\r\n  componentWillMount () {\r\n    this.state = { entity: this.props.options.entity }\r\n  }\r\n\r\n  async generateLink (method) {\r\n    const response = await Studio.api.post(`/api/templates/sharing/${this.props.options.entity.shortid}/access/${method}`, {})\r\n    const entity = this.state.entity\r\n    const tokenProperty = method + 'SharingToken'\r\n    const updated = {\r\n      ...entity,\r\n      [tokenProperty]: response.token\r\n    }\r\n    Studio.updateEntity(updated)\r\n    this.setState({ entity: updated })\r\n  }\r\n\r\n  async removeLink () {\r\n    Studio.updateEntity({_id: this.state.entity._id, readSharingToken: null})\r\n    Studio.saveEntity(this.state.entity._id)\r\n    this.setState({entity: {...this.state.entity, readSharingToken: null}})\r\n  }\r\n\r\n  render () {\r\n    const { entity } = this.state\r\n\r\n    return <div>\r\n      <h2>Link with read permissions</h2>\r\n      {entity.readSharingToken ? <div>\r\n        <a target='_blank' href={Studio.rootUrl + `/public-templates?access_token=${entity.readSharingToken}`}>\r\n          {Studio.rootUrl + `/public-templates?access_token=${entity.readSharingToken}`}\r\n        </a>\r\n      </div> : <div>\r\n        <button type='button' className='button confirmation' onClick={() => this.generateLink('read')}>Generate Read Link\r\n        </button>\r\n      </div>\r\n      }\r\n      <div className={Style.infoBox}>\r\n        When requesting this link, jsreport will skip the authentication and authorization and render this\r\n        particular template. User will be also able to execute\r\n        any of the jsreport recipes from the served page but won't be allowed to access any of the existing\r\n        templates or other entities.\r\n      </div>\r\n\r\n      <div className='button-bar'>\r\n        <button className='button confirmation' onClick={() => this.props.close()}>ok</button>\r\n        {entity.readSharingToken ? <button className='button danger' onClick={() => this.removeLink()}>Remove</button> : <span />}\r\n      </div>\r\n    </div>\r\n  }\r\n}\r\n","module.exports = Studio.libraries['react'];","// extracted by mini-css-extract-plugin\nmodule.exports = {\"infoBox\":\"x-public-templates-ShareModal-infoBox\"};"],"sourceRoot":""}